<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header justify-content-between">
      @if (type === "send") {
        <h5 class="modal-title" id="exampleModalLabel">Compose Email</h5>
      } @else {
        <h5>{{ selectedEmail?.subject }}</h5>
      }
      <div
        class="close close-btn"
        data-dismiss="modal"
        aria-label="Close"
        (click)="openEmailModal()"
      >
        &#x2715;
      </div>
    </div>
    <div class="modal-body">
      <form (submit)="handleSubmit()">
        <div class="form-group form-input-section">
          <label for="to">To:</label>
          <span class="d-flex gap-2" (click)="handleEmailStack($event, 'to')">
            @for (emailR of emailRecp.to; track $index) {
              <span class="to-email" id="{{ emailR.id }}">
                {{ emailR.recp }}
                <i class="fa-solid fa-xmark" id="{{ emailR.id }}"></i>
              </span>
            }
          </span>

          <input
            type="email"
            id="to"
            name="to"
            [(ngModel)]="email.to"
            required
            class="form-control"
            (keyup)="handleEmailAddressEntries($event, 'to')"
          />
        </div>
        @if (type !== "reply") {
          <div class="form-group form-input-section">
            <label for="subject">Subject:</label>
            <input
              type="text"
              id="subject"
              name="subject"
              [(ngModel)]="email.subject"
              required
              class="form-control"
            />
          </div>
        }
        <div class="form-group" style="position: relative">
          <div class="textarea-header-section">
            <label for="body">Body:</label>
            @if (type === "forward") {
              <div class="plain-body-txt" [innerHTML]="email.body"></div>
            } @else {
              <div id="editor" (keyup)="calcCursorPos($event)"></div>
              <div class="suggestion-block">
                <span class="suggestion-block-span">
                  {{ suggestionText }}
                </span>
              </div>
            }
          </div>
        </div>

        @if (type !== "forward") {
          <app-file-upload
            (uploadedFilesEmit)="files = $event"
          ></app-file-upload>
        }
        <div class="mt-3">
          <button type="submit" class="btn btn-success">Send</button>
        </div>
      </form>
    </div>
  </div>
</div>
